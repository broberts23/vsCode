<?xml version="1.0" encoding="utf-8" standalone="no"?>
<test-results xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="nunit_schema_2.5.xsd" name="Pester" total="57" errors="0" failures="0" not-run="0" inconclusive="0" ignored="0" skipped="4" invalid="0" date="2025-12-14" time="19:29:53">
  <environment clr-version="9.0.10" user-domain="" nunit-version="2.5.8.0" os-version="6.17.9-arch1-1" user="ben" machine-name="rig" cwd="/home/ben/vsCode/project-functionapp-roles" platform="Linux" />
  <culture-info current-culture="en-GB" current-uiculture="en-GB" />
  <test-suite type="TestFixture" name="Pester" executed="True" result="Ignored" success="True" time="2.1111" asserts="0" description="Pester">
    <results>
      <test-suite type="TestFixture" name="/home/ben/vsCode/project-functionapp-roles/tests/Unit/PasswordResetHelpers.Tests.ps1" executed="True" result="Success" success="True" time="1.6176" asserts="0" description="/home/ben/vsCode/project-functionapp-roles/tests/Unit/PasswordResetHelpers.Tests.ps1">
        <results>
          <test-suite type="TestFixture" name="PasswordResetHelpers Module" executed="True" result="Success" success="True" time="1.3351" asserts="0" description="PasswordResetHelpers Module">
            <results>
              <test-suite type="TestFixture" name="PasswordResetHelpers Module.Module Load" executed="True" result="Success" success="True" time="0.1499" asserts="0" description="PasswordResetHelpers Module.Module Load">
                <results>
                  <test-case description="Should load the module successfully" name="PasswordResetHelpers Module.Module Load.Should load the module successfully" time="0.079" asserts="0" success="True" result="Success" executed="True" />
                  <test-case description="Should export Get-ClientPrincipal function" name="PasswordResetHelpers Module.Module Load.Should export Get-ClientPrincipal function" time="0.0104" asserts="0" success="True" result="Success" executed="True" />
                  <test-case description="Should export Test-RoleClaim function" name="PasswordResetHelpers Module.Module Load.Should export Test-RoleClaim function" time="0.0085" asserts="0" success="True" result="Success" executed="True" />
                  <test-case description="Should export New-SecurePassword function" name="PasswordResetHelpers Module.Module Load.Should export New-SecurePassword function" time="0.0086" asserts="0" success="True" result="Success" executed="True" />
                  <test-case description="Should export Set-ADUserPassword function" name="PasswordResetHelpers Module.Module Load.Should export Set-ADUserPassword function" time="0.0087" asserts="0" success="True" result="Success" executed="True" />
                  <test-case description="Should export ConvertFrom-LdapsCertificateBase64 function" name="PasswordResetHelpers Module.Module Load.Should export ConvertFrom-LdapsCertificateBase64 function" time="0.0088" asserts="0" success="True" result="Success" executed="True" />
                  <test-case description="Should export Get-ADUserDistinguishedName function" name="PasswordResetHelpers Module.Module Load.Should export Get-ADUserDistinguishedName function" time="0.0098" asserts="0" success="True" result="Success" executed="True" />
                </results>
              </test-suite>
              <test-suite type="TestFixture" name="PasswordResetHelpers Module.Get-ClientPrincipal" executed="True" result="Success" success="True" time="0.2609" asserts="0" description="PasswordResetHelpers Module.Get-ClientPrincipal">
                <results>
                  <test-case description="Should throw on null header" name="PasswordResetHelpers Module.Get-ClientPrincipal.Should throw on null header" time="0.025" asserts="0" success="True" result="Success" executed="True" />
                  <test-case description="Should throw on empty header" name="PasswordResetHelpers Module.Get-ClientPrincipal.Should throw on empty header" time="0.0049" asserts="0" success="True" result="Success" executed="True" />
                  <test-case description="Should throw on invalid base64" name="PasswordResetHelpers Module.Get-ClientPrincipal.Should throw on invalid base64" time="0.0087" asserts="0" success="True" result="Success" executed="True" />
                  <test-case description="Should decode valid client principal header" name="PasswordResetHelpers Module.Get-ClientPrincipal.Should decode valid client principal header" time="0.0425" asserts="0" success="True" result="Success" executed="True" />
                  <test-case description="Should return principal with claims array" name="PasswordResetHelpers Module.Get-ClientPrincipal.Should return principal with claims array" time="0.0094" asserts="0" success="True" result="Success" executed="True" />
                  <test-case description="Should handle principal with multiple claims" name="PasswordResetHelpers Module.Get-ClientPrincipal.Should handle principal with multiple claims" time="0.0033" asserts="0" success="True" result="Success" executed="True" />
                </results>
              </test-suite>
              <test-suite type="TestFixture" name="PasswordResetHelpers Module.Test-RoleClaim" executed="True" result="Success" success="True" time="0.3049" asserts="0" description="PasswordResetHelpers Module.Test-RoleClaim">
                <results>
                  <test-case description="Should throw on null principal" name="PasswordResetHelpers Module.Test-RoleClaim.Should throw on null principal" time="0.0055" asserts="0" success="True" result="Success" executed="True" />
                  <test-case description="Should return true when required role exists" name="PasswordResetHelpers Module.Test-RoleClaim.Should return true when required role exists" time="0.0089" asserts="0" success="True" result="Success" executed="True" />
                  <test-case description="Should return false when required role does not exist" name="PasswordResetHelpers Module.Test-RoleClaim.Should return false when required role does not exist" time="0.0037" asserts="0" success="True" result="Success" executed="True" />
                  <test-case description="Should return false when no roles exist" name="PasswordResetHelpers Module.Test-RoleClaim.Should return false when no roles exist" time="0.0037" asserts="0" success="True" result="Success" executed="True" />
                  <test-case description="Should return false when no claims exist" name="PasswordResetHelpers Module.Test-RoleClaim.Should return false when no claims exist" time="0.0113" asserts="0" success="True" result="Success" executed="True" />
                  <test-case description="Should be case-sensitive for role matching" name="PasswordResetHelpers Module.Test-RoleClaim.Should be case-sensitive for role matching" time="0.0037" asserts="0" success="True" result="Success" executed="True" />
                  <test-case description="Should handle role claim type" name="PasswordResetHelpers Module.Test-RoleClaim.Should handle role claim type" time="0.0035" asserts="0" success="True" result="Success" executed="True" />
                </results>
              </test-suite>
              <test-suite type="TestFixture" name="PasswordResetHelpers Module.New-SecurePassword" executed="True" result="Success" success="True" time="0.4017" asserts="0" description="PasswordResetHelpers Module.New-SecurePassword">
                <results>
                  <test-case description="Should generate a password of default length" name="PasswordResetHelpers Module.New-SecurePassword.Should generate a password of default length" time="0.0185" asserts="0" success="True" result="Success" executed="True" />
                  <test-case description="Should generate a password of specified length" name="PasswordResetHelpers Module.New-SecurePassword.Should generate a password of specified length" time="0.0043" asserts="0" success="True" result="Success" executed="True" />
                  <test-case description="Should generate password with minimum length" name="PasswordResetHelpers Module.New-SecurePassword.Should generate password with minimum length" time="0.004" asserts="0" success="True" result="Success" executed="True" />
                  <test-case description="Should throw for length below minimum" name="PasswordResetHelpers Module.New-SecurePassword.Should throw for length below minimum" time="0.0038" asserts="0" success="True" result="Success" executed="True" />
                  <test-case description="Should throw for length above maximum" name="PasswordResetHelpers Module.New-SecurePassword.Should throw for length above maximum" time="0.0038" asserts="0" success="True" result="Success" executed="True" />
                  <test-case description="Should contain at least one lowercase character" name="PasswordResetHelpers Module.New-SecurePassword.Should contain at least one lowercase character" time="0.0055" asserts="0" success="True" result="Success" executed="True" />
                  <test-case description="Should contain at least one uppercase character" name="PasswordResetHelpers Module.New-SecurePassword.Should contain at least one uppercase character" time="0.0069" asserts="0" success="True" result="Success" executed="True" />
                  <test-case description="Should contain at least one number" name="PasswordResetHelpers Module.New-SecurePassword.Should contain at least one number" time="0.0035" asserts="0" success="True" result="Success" executed="True" />
                  <test-case description="Should contain at least one special character" name="PasswordResetHelpers Module.New-SecurePassword.Should contain at least one special character" time="0.004" asserts="0" success="True" result="Success" executed="True" />
                  <test-case description="Should generate unique passwords" name="PasswordResetHelpers Module.New-SecurePassword.Should generate unique passwords" time="0.005" asserts="0" success="True" result="Success" executed="True" />
                  <test-case description="Should generate passwords consistently meeting complexity requirements" name="PasswordResetHelpers Module.New-SecurePassword.Should generate passwords consistently meeting complexity requirements" time="0.0344" asserts="0" success="True" result="Success" executed="True" />
                </results>
              </test-suite>
              <test-suite type="TestFixture" name="PasswordResetHelpers Module.ConvertFrom-LdapsCertificateBase64" executed="True" result="Success" success="True" time="0.9776" asserts="0" description="PasswordResetHelpers Module.ConvertFrom-LdapsCertificateBase64">
                <results>
                  <test-case description="Should throw on null certificate" name="PasswordResetHelpers Module.ConvertFrom-LdapsCertificateBase64.Should throw on null certificate" time="0.0066" asserts="0" success="True" result="Success" executed="True" />
                  <test-case description="Should throw on empty certificate" name="PasswordResetHelpers Module.ConvertFrom-LdapsCertificateBase64.Should throw on empty certificate" time="0.0048" asserts="0" success="True" result="Success" executed="True" />
                  <test-case description="Should throw on invalid base64" name="PasswordResetHelpers Module.ConvertFrom-LdapsCertificateBase64.Should throw on invalid base64" time="0.0081" asserts="0" success="True" result="Success" executed="True" />
                  <test-case description="Should parse a valid DER certificate" name="PasswordResetHelpers Module.ConvertFrom-LdapsCertificateBase64.Should parse a valid DER certificate" time="0.3532" asserts="0" success="True" result="Success" executed="True" />
                  <test-case description="Should parse a valid PEM certificate" name="PasswordResetHelpers Module.ConvertFrom-LdapsCertificateBase64.Should parse a valid PEM certificate" time="0.2003" asserts="0" success="True" result="Success" executed="True" />
                </results>
              </test-suite>
              <test-suite type="TestFixture" name="PasswordResetHelpers Module.Get-ADUserDistinguishedName" executed="True" result="Success" success="True" time="1.007" asserts="0" description="PasswordResetHelpers Module.Get-ADUserDistinguishedName">
                <results>
                  <test-case description="Should throw on null SamAccountName" name="PasswordResetHelpers Module.Get-ADUserDistinguishedName.Should throw on null SamAccountName" time="0.0216" asserts="0" success="True" result="Success" executed="True" />
                  <test-case description="Should throw on empty SamAccountName" name="PasswordResetHelpers Module.Get-ADUserDistinguishedName.Should throw on empty SamAccountName" time="0.0048" asserts="0" success="True" result="Success" executed="True" />
                </results>
              </test-suite>
              <test-suite type="TestFixture" name="PasswordResetHelpers Module.Set-ADUserPassword" executed="True" result="Success" success="True" time="1.3288" asserts="0" description="PasswordResetHelpers Module.Set-ADUserPassword">
                <results>
                  <test-case description="Should throw on null SamAccountName" name="PasswordResetHelpers Module.Set-ADUserPassword.Should throw on null SamAccountName" time="0.013" asserts="0" success="True" result="Success" executed="True" />
                  <test-case description="Should throw on empty SamAccountName" name="PasswordResetHelpers Module.Set-ADUserPassword.Should throw on empty SamAccountName" time="0.0172" asserts="0" success="True" result="Success" executed="True" />
                  <test-case description="Should throw on null Password" name="PasswordResetHelpers Module.Set-ADUserPassword.Should throw on null Password" time="0.0078" asserts="0" success="True" result="Success" executed="True" />
                  <test-case description="Should throw on empty Password" name="PasswordResetHelpers Module.Set-ADUserPassword.Should throw on empty Password" time="0.0124" asserts="0" success="True" result="Success" executed="True" />
                  <test-case description="Should attempt to get user DN when called with valid parameters" name="PasswordResetHelpers Module.Set-ADUserPassword.Should attempt to get user DN when called with valid parameters" time="0.1037" asserts="0" success="True" result="Success" executed="True" />
                  <test-case description="Should throw when user not found" name="PasswordResetHelpers Module.Set-ADUserPassword.Should throw when user not found" time="0.0361" asserts="0" success="True" result="Success" executed="True" />
                  <test-case description="Should accept pipeline input for SamAccountName" name="PasswordResetHelpers Module.Set-ADUserPassword.Should accept pipeline input for SamAccountName" time="0.0128" asserts="0" success="True" result="Success" executed="True" />
                  <test-case description="Should have required parameters defined" name="PasswordResetHelpers Module.Set-ADUserPassword.Should have required parameters defined" time="0.0151" asserts="0" success="True" result="Success" executed="True" />
                  <test-case description="Should support ShouldProcess (WhatIf/Confirm)" name="PasswordResetHelpers Module.Set-ADUserPassword.Should support ShouldProcess (WhatIf/Confirm)" time="0.0107" asserts="0" success="True" result="Success" executed="True" />
                </results>
              </test-suite>
            </results>
          </test-suite>
          <test-suite type="TestFixture" name="PasswordResetHelpers Module Integration Tests" executed="True" result="Success" success="True" time="1.3522" asserts="0" description="PasswordResetHelpers Module Integration Tests">
            <results>
              <test-suite type="TestFixture" name="PasswordResetHelpers Module Integration Tests.End-to-End Password Generation and Validation" executed="True" result="Success" success="True" time="0.0134" asserts="0" description="PasswordResetHelpers Module Integration Tests.End-to-End Password Generation and Validation">
                <results>
                  <test-case description="Should generate password that meets all requirements" name="PasswordResetHelpers Module Integration Tests.End-to-End Password Generation and Validation.Should generate password that meets all requirements" time="0.0105" asserts="0" success="True" result="Success" executed="True" />
                </results>
              </test-suite>
            </results>
          </test-suite>
        </results>
      </test-suite>
      <test-suite type="TestFixture" name="/home/ben/vsCode/project-functionapp-roles/tests/Integration/ResetUserPassword.Tests.ps1" executed="True" result="Ignored" success="True" time="0.4936" asserts="0" description="/home/ben/vsCode/project-functionapp-roles/tests/Integration/ResetUserPassword.Tests.ps1">
        <results>
          <test-suite type="TestFixture" name="ResetUserPassword Function" executed="True" result="Ignored" success="True" time="0.3797" asserts="0" description="ResetUserPassword Function">
            <results>
              <test-suite type="TestFixture" name="ResetUserPassword Function.Request Validation" executed="True" result="Success" success="True" time="0.1329" asserts="0" description="ResetUserPassword Function.Request Validation">
                <results>
                  <test-case description="Should reject missing X-MS-CLIENT-PRINCIPAL in header" name="ResetUserPassword Function.Request Validation.Should reject missing X-MS-CLIENT-PRINCIPAL in header" time="0.062" asserts="0" success="True" result="Success" executed="True" />
                  <test-case description="Should reject invalid client principal (not base64)" name="ResetUserPassword Function.Request Validation.Should reject invalid client principal (not base64)" time="0.0298" asserts="0" success="True" result="Success" executed="True" />
                  <test-case description="Should reject request without samAccountName in body" name="ResetUserPassword Function.Request Validation.Should reject request without samAccountName in body" time="0.0382" asserts="0" success="True" result="Success" executed="True" />
                </results>
              </test-suite>
              <test-suite type="TestFixture" name="ResetUserPassword Function.Client Principal Validation" executed="True" result="Success" success="True" time="0.1676" asserts="0" description="ResetUserPassword Function.Client Principal Validation">
                <results>
                  <test-case description="Should reject invalid client principal" name="ResetUserPassword Function.Client Principal Validation.Should reject invalid client principal" time="0.0318" asserts="0" success="True" result="Success" executed="True" />
                </results>
              </test-suite>
              <test-suite type="TestFixture" name="ResetUserPassword Function.Role Authorization" executed="True" result="Ignored" success="True" time="0.2888" asserts="0" description="ResetUserPassword Function.Role Authorization">
                <results>
                  <test-case description="Should reject requests without required role" name="ResetUserPassword Function.Role Authorization.Should reject requests without required role" time="0.0517" asserts="0" success="True" result="Success" executed="True" />
                  <test-case description="Should accept requests with required role" name="ResetUserPassword Function.Role Authorization.Should accept requests with required role" time="0.0622" asserts="0" success="False" result="Ignored" executed="False" />
                </results>
              </test-suite>
              <test-suite type="TestFixture" name="ResetUserPassword Function.Password Reset Operations" executed="True" result="Ignored" success="True" time="0.3771" asserts="0" description="ResetUserPassword Function.Password Reset Operations">
                <results>
                  <test-case description="Should return generated password on successful reset" name="ResetUserPassword Function.Password Reset Operations.Should return generated password on successful reset" time="0.0292" asserts="0" success="False" result="Ignored" executed="False" />
                  <test-case description="Should handle user not found error" name="ResetUserPassword Function.Password Reset Operations.Should handle user not found error" time="0.0271" asserts="0" success="False" result="Ignored" executed="False" />
                  <test-case description="Should include security headers in response" name="ResetUserPassword Function.Password Reset Operations.Should include security headers in response" time="0.0291" asserts="0" success="False" result="Ignored" executed="False" />
                </results>
              </test-suite>
            </results>
          </test-suite>
        </results>
      </test-suite>
    </results>
  </test-suite>
</test-results>