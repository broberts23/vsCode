name: PIM Elevate Demo - Usage Example

# This workflow demonstrates calling the reusable template `pim-elevate.yml`.
# Trigger it manually (Actions → PIM Elevate Demo - Usage Example → Run workflow) and

on:
  workflow_dispatch:

jobs:
  call-pim-template:
    name: Call reusable PIM template (demo)
    # Call the reusable workflow by repository path and ref. The path points to the
    # workflow file inside the `project-jit-pim` folder in this repo.
    uses: broberts23/vsCode/project-jit-pim/.github/workflows/pim-elevate.yml@main
    with:
      # Example single-role / single-resource pairing. Replace with real IDs in your tenant.
      roleIds: '["b86a8fe4-44ce-4948-aee5-eccb2c155cd7"]'
      # Build the resource ID at runtime using the AZURE_SUBSCRIPTION_ID secret and
      # convert to JSON so the called workflow receives a JSON array string.
      resourceIds: ${{ format('["/subscriptions/{0}/resourceGroups/{1}/providers/Microsoft.KeyVault/vaults/{2}"]', secrets.AZURE_SUBSCRIPTION_ID, 'my-rg', 'kvozvlgqf3cdcia') }}
    # Pass repository secrets through to the called workflow (inherit all repo secrets).
    secrets: inherit
